<!doctype html>
<html>
<head>

<meta charset="UTF-8"/>
<script src="../../phaser/phaser.min.js"></script>
<title>Billy you should quit smoking</title>

</head>
<body>
<script type="text/javascript">

window.onload = function() {

	var game = new Phaser.Game(960, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
	var billySprite;
	var life;
	var obstacle1 ;
	var obstacle2 ;

	function preload () {
		game.load.image('background', 'assets/background_960_600.png');
		game.load.image('obstacle1', 'assets/obstacle1_167_42_03.png');
		game.load.image('obstacle2', 'assets/obstacle2_154_42_03.png');
		game.load.image('life', 'assets/heart_35_28_03.png');
		game.load.spritesheet('billy', 'assets/smoker_76_90_3.png', 76,90);
		// game.load.image('logo', 'assets/logo_547_421_03.png');
	}

	function create () {
		var background = game.add.sprite(0,0, 'background');
		obstacle1 = game.add.sprite(250,350, 'obstacle1');
		obstacle2 = game.add.sprite(720,418.5, 'obstacle2');
		
//		obstacle1.enableBody = true;
//		obstacle1.body.immovable = true;
//		game.physics.enable(obstacle1, Phaser.Physics.ARCADE);
//		obstacle2.enableBody = true;
//		obstacle2.body.immovable = true;
//		game.physics.enable(obstacle2, Phaser.Physics.ARCADE);
		
		life = game.add.sprite(500,200, 'life');
		game.physics.enable(life, Phaser.Physics.ARCADE);
		
		billySprite = game.add.sprite(0, 481.5, 'billy');
		billySprite.animations.add('walk',[1,2,3],2,true);
		billySprite.animations.add('jump',[1, 2,3],1,true);
		game.physics.enable(billySprite, Phaser.Physics.ARCADE); 

		billySprite.body.acceleration.y = 150;

		billySprite.body.collideWorldBounds = true; // para no limite inferio da tela
		billySprite.body.drag.x = 50; //desloca 100 e para, só desloca de novo se clicada alguma tecla e quanto maior for seu valor, menos desloca
		billySprite.anchor.setTo(.5,.5); // diminui o espaço do deslocamento do espelhamento 
		billySprite.body.gravity.y = 150;

		// var ground = plataforms.create (0, game.world.height - 20.5, 'ground')  

	}

	function update () {

		// COLISAO COM OSSO:
		game.physics.arcade.overlap(billySprite, life, billyEatLife,null,this);


		// PEGA A ENTRADA (tecla pressionada):	
		if ( game.input.keyboard.isDown (Phaser.Keyboard.LEFT) ) { // vai para esquerda

			billySprite.body.velocity.x = -20;
			billySprite.animations.play('walk');
			billySprite.scale.x = -1; // espelha se antes -1
		}

		else if ( game.input.keyboard.isDown (Phaser.Keyboard.RIGHT) ) { // vai para direita

			billySprite.body.velocity.x = 20;
			billySprite.scale.x = +1;  // espelha se antes 1
			billySprite.animations.play('walk');
		}

		else if ( game.input.keyboard.isDown (Phaser.Keyboard.UP) ) { // vai para cima

			billySprite.body.velocity.y = -100;
			billySprite.animations.play('jump');
		}

		else{
			billySprite.animations.stop();
			billySprite.frame = 0;
		}	
	}

	function billyEatLife (billy,life)	{

		life.kill();
	}
};
</script>
</body>

</html>